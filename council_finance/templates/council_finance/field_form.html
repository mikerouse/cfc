{% extends "base.html" %}
{% block title %}Edit Field - Council Finance Counters{% endblock %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">{{ form.instance.pk|yesno:'Edit Field,Add Field' }}</h1>
<form method="post" class="space-y-4">
    {% csrf_token %}
    <table class="min-w-full border border-gray-300">
        <tbody>
            {# Give each row an id so JS can toggle the dataset field #}
            {% for field in form %}
            <tr class="odd:bg-gray-50" id="row-{{ field.name }}">
                <th class="text-left p-2 border w-40">{{ field.label_tag }}</th>
                <td class="p-2 border">{{ field }}{{ field.errors }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div class="text-right">
        <button type="submit" class="bg-blue-600 text-white px-4 py-1 rounded">Save</button>
        {% if form.instance.pk and not form.instance.is_protected %}
        <a href="{% url 'field_delete' form.instance.slug %}" class="ml-2 text-red-600 underline">Delete</a>
        {% endif %}
    </div>
</form>
<script>
const typeSelect = document.getElementById('id_content_type');
const datasetRow = document.getElementById('row-dataset_type');
function toggleDataset() {
    if (typeSelect.value === 'list') {
        datasetRow.style.display = '';
    } else {
        datasetRow.style.display = 'none';
    }
}
if (typeSelect && datasetRow) {
    toggleDataset();
    typeSelect.addEventListener('change', toggleDataset);
}
</script>
{% endblock %}
